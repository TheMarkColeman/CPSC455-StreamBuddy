{"ast":null,"code":"var _jsxFileName = \"/Users/nazishtazeem/WebstormProjects/CPSC455-StreamBuddy/streambuddy/src/components/MovieCardActions.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport { UserContext } from \"./UserContext\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Backdrop, Divider, Fade, Modal, Snackbar } from \"@material-ui/core\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport RatingsAndReviewInput from \"./RatingsAndReviewInput\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst options = ['Mark As Seen', 'Add to Watchlist', 'Rate / Review'];\n\nfunction Alert(props) {\n  return /*#__PURE__*/_jsxDEV(MuiAlert, {\n    elevation: 6,\n    variant: \"filled\",\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 12\n  }, this);\n}\n\n_c = Alert;\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n    '& > * + *': {\n      marginTop: theme.spacing(2)\n    }\n  },\n  paper: {\n    padding: 3,\n    marginTop: \"15%\"\n  },\n  modal: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    overflow: 'scroll'\n  }\n}));\nexport default function MovieCardActions(props) {\n  _s();\n\n  const [open, setOpen] = React.useState(false);\n  const anchorRef = React.useRef(null);\n  const [selectedIndex, setSelectedIndex] = React.useState(1);\n  const [loginReminderAlert, setLoginReminderAlert] = React.useState(false);\n  const [successAlert, setSuccessAlert] = React.useState(false);\n  const [ratingPopover, setRatingPopover] = React.useState(false);\n  const classes = useStyles();\n  const {\n    user,\n    setUser\n  } = useContext(UserContext);\n\n  const updateUserWatched = (user, item) => {\n    axios.put(`http://localhost:5000/api/users/${user._id}/watched/`, {\n      item\n    }).then(res => {\n      setUser(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const updateUserWatchlist = (user, item) => {\n    axios.put(`http://localhost:5000/api/users/${user._id}/watchlist/`, {\n      item\n    }).then(res => {\n      setUser(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const handlePopoverOpen = event => {\n    setRatingPopover(true);\n  };\n\n  const handlePopoverClose = () => {\n    setRatingPopover(false);\n  };\n\n  const handleClose1 = (event, reason) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n\n    setLoginReminderAlert(false);\n    setSuccessAlert(false);\n  };\n\n  const handleClick = () => {\n    if (user === null) {\n      setLoginReminderAlert(true);\n      return;\n    }\n\n    console.info(`You clicked ${options[selectedIndex]}`);\n\n    if (options[selectedIndex] === 'Mark As Seen') {\n      console.log(\"Mark as seen from button!!\");\n      updateUserWatched(user, props.item);\n      setSuccessAlert(true);\n      console.log(\"user watched updated successfully\");\n    } else if (options[selectedIndex] === 'Add to Watchlist') {\n      console.log(\"Add to Watchlist from button!!!\");\n      updateUserWatchlist(user, props.item);\n      setSuccessAlert(true);\n    } else if (options[selectedIndex] === 'Rate / Review') {\n      handlePopoverOpen();\n      console.log(\"Rate / Review from button!!!\");\n    }\n  };\n\n  const handleMenuItemClick = (event, index) => {\n    if (user === null) {\n      setLoginReminderAlert(true);\n      return;\n    }\n\n    setSelectedIndex(index);\n    setOpen(false);\n    console.info(`You clicked ${options[index]}`, index);\n\n    if (index === 0) {} else if (index === 1) {} else if (index === 2) {}\n  };\n\n  const handleToggle = () => {\n    setOpen(prevOpen => !prevOpen);\n  };\n\n  const handleClose = event => {\n    if (anchorRef.current && anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  }; // checks whether the user has already reviewed this movie\n  // TODO: not yet used because it returned true for all movies -- need to fix\n\n\n  const alreadyReviewed = () => {\n    console.log(\"checking if alreadyReviewed\");\n\n    if (!user || user.reviews || !Array.isArray(user.reviews) || !user.reviews.length) {\n      console.log(\"user: \", user);\n      console.log(\"user.reviews: \", user.reviews);\n      console.log(\"return false\");\n      return false;\n    }\n\n    const movieAlreadyReviewed = user.reviews.filter(review => review.movieTitle === props.item.Title);\n    console.log(\"movieAlreadyReviewed is \", movieAlreadyReviewed);\n\n    if (movieAlreadyReviewed === 1) {\n      console.log(\"this movie has already been reviewed\");\n      return true;\n    } else {\n      console.log(\"this movie has not yet been removed\");\n      return false;\n    }\n  }; // TOODO: add movieId={props.item._id} to Reviews once we use real data (so we can reuse the reviews for more purposes)\n\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    alignItems: \"center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.root,\n      children: [/*#__PURE__*/_jsxDEV(Snackbar, {\n        open: loginReminderAlert,\n        autoHideDuration: 3000,\n        onClose: handleClose1,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          onClose: handleClose1,\n          severity: \"info\",\n          children: \"Please Login/Register first!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 43\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        open: successAlert,\n        autoHideDuration: 3000,\n        onClose: handleClose1,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          onClose: handleClose1,\n          severity: \"success\",\n          children: \"Success!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: ratingPopover,\n      className: classes.modal,\n      onClose: handlePopoverClose,\n      closeAfterTransition: true,\n      disableScrollLock: true,\n      BackdropComponent: Backdrop,\n      BackdropProps: {\n        timeout: 500\n      },\n      disableRestoreFocus: true,\n      children: /*#__PURE__*/_jsxDEV(Fade, {\n        in: ratingPopover,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.paper,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"popovertext\",\n            style: {\n              maxWidth: 900,\n              width: 500,\n              padding: 40,\n              backgroundColor: \"white\",\n              position: \"flex\",\n              zIndex: 10\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"Rate And Review\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              style: {\n                marginTop: 20,\n                marginBottom: 20\n              },\n              children: [\" \", props.item.Title]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              src: props.item.Poster\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(RatingsAndReviewInput, {\n              moviePoster: props.item.Poster,\n              movieTitle: props.item.Title,\n              onPostClick: handlePopoverClose\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: [/*#__PURE__*/_jsxDEV(ButtonGroup, {\n        variant: \"contained\",\n        color: \"primary\",\n        ref: anchorRef,\n        \"aria-label\": \"split button\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleClick,\n          children: options[selectedIndex]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"primary\",\n          size: \"small\",\n          \"aria-controls\": open ? 'split-button-menu' : undefined,\n          \"aria-expanded\": open ? 'true' : undefined,\n          \"aria-label\": \"select merge strategy\",\n          \"aria-haspopup\": \"menu\",\n          onClick: handleToggle,\n          children: /*#__PURE__*/_jsxDEV(ArrowDropDownIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Popper, {\n        open: open,\n        anchorEl: anchorRef.current,\n        role: undefined,\n        transition: true,\n        disablePortal: true,\n        style: {\n          zIndex: 1\n        },\n        children: ({\n          TransitionProps,\n          placement\n        }) => /*#__PURE__*/_jsxDEV(Grow, { ...TransitionProps,\n          style: {\n            transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom'\n          },\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            children: /*#__PURE__*/_jsxDEV(ClickAwayListener, {\n              onClickAway: handleClose,\n              children: /*#__PURE__*/_jsxDEV(MenuList, {\n                id: \"split-button-menu\",\n                style: {\n                  zIndex: 1\n                },\n                children: options.map((option, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n                  // disabled={index === 2}\n                  selected: index === selectedIndex,\n                  onClick: event => handleMenuItemClick(event, index),\n                  children: option\n                }, option, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 45\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MovieCardActions, \"8BNFkmrPoGPKDIQ+/QJxbydbPVs=\", false, function () {\n  return [useStyles];\n});\n\n_c2 = MovieCardActions;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Alert\");\n$RefreshReg$(_c2, \"MovieCardActions\");","map":{"version":3,"sources":["/Users/nazishtazeem/WebstormProjects/CPSC455-StreamBuddy/streambuddy/src/components/MovieCardActions.js"],"names":["React","useContext","Grid","Button","ButtonGroup","ArrowDropDownIcon","ClickAwayListener","Grow","Paper","Popper","MenuItem","MenuList","UserContext","makeStyles","Backdrop","Divider","Fade","Modal","Snackbar","MuiAlert","RatingsAndReviewInput","axios","options","Alert","props","useStyles","theme","root","width","marginTop","spacing","paper","padding","modal","display","alignItems","justifyContent","overflow","MovieCardActions","open","setOpen","useState","anchorRef","useRef","selectedIndex","setSelectedIndex","loginReminderAlert","setLoginReminderAlert","successAlert","setSuccessAlert","ratingPopover","setRatingPopover","classes","user","setUser","updateUserWatched","item","put","_id","then","res","data","catch","err","console","log","updateUserWatchlist","handlePopoverOpen","event","handlePopoverClose","handleClose1","reason","handleClick","info","handleMenuItemClick","index","handleToggle","prevOpen","handleClose","current","contains","target","alreadyReviewed","reviews","Array","isArray","length","movieAlreadyReviewed","filter","review","movieTitle","Title","timeout","maxWidth","backgroundColor","position","zIndex","marginBottom","Poster","undefined","TransitionProps","placement","transformOrigin","map","option"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport {UserContext} from \"./UserContext\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport {Backdrop, Divider, Fade, Modal, Snackbar} from \"@material-ui/core\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport RatingsAndReviewInput from \"./RatingsAndReviewInput\";\nimport axios from \"axios\";\n\nconst options = ['Mark As Seen', 'Add to Watchlist', 'Rate / Review'];\n\nfunction Alert(props) {\n    return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        width: '100%',\n        '& > * + *': {\n            marginTop: theme.spacing(2),\n        },\n    },\n    paper: {\n        padding: 3,\n        marginTop: \"15%\"\n    },\n    modal: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        overflow:'scroll'\n    },\n}));\n\nexport default function MovieCardActions(props) {\n    const [open, setOpen] = React.useState(false);\n    const anchorRef = React.useRef(null);\n    const [selectedIndex, setSelectedIndex] = React.useState(1);\n    const [loginReminderAlert, setLoginReminderAlert] = React.useState(false);\n    const [successAlert, setSuccessAlert] = React.useState(false);\n    const [ratingPopover, setRatingPopover] = React.useState(false);\n    const classes = useStyles();\n    const {user, setUser} = useContext(UserContext);\n\n\n    const updateUserWatched = (user, item) => {\n        axios.put(`http://localhost:5000/api/users/${user._id}/watched/`, {\n            item\n        }).then((res) => {\n            setUser(res.data);\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n\n    const updateUserWatchlist = (user, item) => {\n        axios.put(`http://localhost:5000/api/users/${user._id}/watchlist/`, {\n            item\n        }).then((res) => {\n            setUser(res.data);\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n\n    const handlePopoverOpen = (event) => {\n        setRatingPopover(true);\n    };\n\n    const handlePopoverClose = () => {\n        setRatingPopover(false);\n    };\n\n    const handleClose1 = (event, reason) => {\n        if (reason === 'clickaway') {\n            return;\n        }\n        setLoginReminderAlert(false);\n        setSuccessAlert(false);\n    };\n\n    const handleClick = () => {\n        if (user === null) {\n            setLoginReminderAlert(true);\n            return;\n        }\n        console.info(`You clicked ${options[selectedIndex]}`);\n        if (options[selectedIndex] === 'Mark As Seen') {\n            console.log(\"Mark as seen from button!!\")\n            updateUserWatched(user, props.item);\n            setSuccessAlert(true);\n            console.log(\"user watched updated successfully\");\n        } else if (options[selectedIndex] === 'Add to Watchlist') {\n            console.log(\"Add to Watchlist from button!!!\")\n            updateUserWatchlist(user, props.item);\n            setSuccessAlert(true)\n        } else if (options[selectedIndex] === 'Rate / Review') {\n            handlePopoverOpen()\n            console.log(\"Rate / Review from button!!!\")\n        }\n    };\n\n    const handleMenuItemClick = (event, index) => {\n        if (user === null) {\n            setLoginReminderAlert(true);\n            return;\n        }\n        setSelectedIndex(index);\n        setOpen(false);\n        console.info(`You clicked ${options[index]}`, index);\n        if (index === 0) {\n        } else if (index === 1) {\n        } else if (index === 2) {\n        }\n    };\n\n    const handleToggle = () => {\n        setOpen((prevOpen) => !prevOpen);\n    };\n\n    const handleClose = (event) => {\n        if (anchorRef.current && anchorRef.current.contains(event.target)) {\n            return;\n        }\n\n        setOpen(false);\n    };\n\n    // checks whether the user has already reviewed this movie\n    // TODO: not yet used because it returned true for all movies -- need to fix\n    const alreadyReviewed = () => {\n        console.log(\"checking if alreadyReviewed\")\n        if (!user || user.reviews || !Array.isArray(user.reviews) || !user.reviews.length) {\n            console.log(\"user: \", user)\n            console.log(\"user.reviews: \", user.reviews)\n            console.log(\"return false\")\n            return false;\n          }\n        const movieAlreadyReviewed = user.reviews.filter(review => review.movieTitle === props.item.Title)\n        console.log(\"movieAlreadyReviewed is \", movieAlreadyReviewed);\n        if (movieAlreadyReviewed === 1) {\n            console.log(\"this movie has already been reviewed\")\n            return true;\n        } else {\n            console.log(\"this movie has not yet been removed\")\n            return false;\n        }\n    }\n\n    // TOODO: add movieId={props.item._id} to Reviews once we use real data (so we can reuse the reviews for more purposes)\n\n    return (\n\n        <Grid container direction=\"column\" alignItems=\"center\">\n            <div className={classes.root}><Snackbar open={loginReminderAlert} autoHideDuration={3000} onClose={handleClose1}>\n                <Alert onClose={handleClose1} severity=\"info\">\n                    Please Login/Register first!\n                </Alert>\n            </Snackbar>\n                <Snackbar open={successAlert} autoHideDuration={3000} onClose={handleClose1}>\n                    <Alert onClose={handleClose1} severity=\"success\">\n                        Success!\n                    </Alert>\n                </Snackbar></div>\n            <Modal open={ratingPopover}\n                   className={classes.modal}\n                   onClose={handlePopoverClose}\n                   closeAfterTransition\n                   disableScrollLock\n                   BackdropComponent={Backdrop}\n                   BackdropProps={{\n                       timeout:500}}\n                   disableRestoreFocus>\n                <Fade in={ratingPopover}>\n                    <div className={classes.paper}>\n                        <div id=\"popovertext\" style={{maxWidth: 900, width: 500, padding: 40, backgroundColor: \"white\", position: \"flex\", zIndex:10}}>\n                            <h1>Rate And Review</h1>\n                            <Divider />\n                            <h2 style={{marginTop: 20, marginBottom: 20}}> {props.item.Title}</h2>\n                            <img src={props.item.Poster}/>\n                            <RatingsAndReviewInput moviePoster={props.item.Poster} movieTitle={props.item.Title} onPostClick={handlePopoverClose} />\n                        </div>\n                    </div>\n                </Fade>\n            </Modal>\n            <Grid item xs={12}>\n                <ButtonGroup variant=\"contained\" color=\"primary\" ref={anchorRef} aria-label=\"split button\">\n                    <Button onClick={handleClick}>{options[selectedIndex]}</Button>\n                    <Button\n                        color=\"primary\"\n                        size=\"small\"\n                        aria-controls={open ? 'split-button-menu' : undefined}\n                        aria-expanded={open ? 'true' : undefined}\n                        aria-label=\"select merge strategy\"\n                        aria-haspopup=\"menu\"\n                        onClick={handleToggle}\n                    >\n                        <ArrowDropDownIcon />\n                    </Button>\n                </ButtonGroup>\n                <Popper open={open} anchorEl={anchorRef.current} role={undefined} transition disablePortal style={{zIndex:1}}>\n                    {({ TransitionProps, placement }) => (\n                        <Grow\n                            {...TransitionProps}\n                            style={{\n                                transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom',\n                            }}\n                        >\n                            <Paper>\n                                <ClickAwayListener onClickAway={handleClose}>\n                                    <MenuList id=\"split-button-menu\" style={{zIndex: 1}}>\n                                        {options.map((option, index) => (\n                                            <MenuItem\n                                                key={option}\n                                                // disabled={index === 2}\n                                                selected={index === selectedIndex}\n                                                onClick={(event) => handleMenuItemClick(event, index)}\n                                            >\n                                                {option}\n                                            </MenuItem>\n                                        ))}\n                                    </MenuList>\n                                </ClickAwayListener>\n                            </Paper>\n                        </Grow>\n                    )}\n                </Popper>\n            </Grid>\n        </Grid>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}